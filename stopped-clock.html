<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stopped Clock Illusion</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #eee;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .back-link {
            align-self: flex-start;
            color: #6366f1;
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #fff;
        }

        .subtitle {
            color: #888;
            margin-bottom: 30px;
            text-align: center;
            max-width: 600px;
            line-height: 1.5;
        }

        .demo-container {
            background: #0d0d1a;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 20px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .trial-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .trial-indicator {
            font-size: 0.9rem;
            color: #6366f1;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .trial-type {
            font-size: 0.85rem;
            color: #888;
        }

        .experiment-area {
            display: flex;
            gap: 60px;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .fixation-area {
            width: 250px;
            height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #16213e;
            border-radius: 12px;
            position: relative;
        }

        .fixation-cross {
            font-size: 48px;
            color: #6366f1;
            font-weight: 300;
            user-select: none;
        }

        .cue-text {
            position: absolute;
            bottom: 30px;
            color: #22c55e;
            font-size: 1rem;
            font-weight: 600;
            text-align: center;
            opacity: 0;
            transition: opacity 0.1s;
        }

        .cue-text.visible {
            opacity: 1;
        }

        .clock-area {
            width: 250px;
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #16213e;
            border-radius: 12px;
        }

        canvas {
            display: block;
        }

        .prompt-text {
            text-align: center;
            font-size: 1.1rem;
            color: #fff;
            margin: 20px 0;
            min-height: 30px;
            font-weight: 500;
        }

        .response-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 500px;
        }

        .slider-container {
            width: 100%;
            margin: 20px 0;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.85rem;
            color: #888;
        }

        .slider-labels span:first-child {
            color: #ef4444;
        }

        .slider-labels span:nth-child(2) {
            color: #888;
        }

        .slider-labels span:last-child {
            color: #22c55e;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #ef4444, #888 50%, #22c55e);
            border-radius: 4px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #6366f1;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid #fff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #6366f1;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid #fff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .slider-value {
            text-align: center;
            font-size: 1.5rem;
            color: #6366f1;
            font-weight: 600;
            margin: 10px 0;
        }

        .slider-scale {
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        button:hover {
            background: #4f46e5;
        }

        button:disabled {
            background: #374151;
            cursor: not-allowed;
            opacity: 0.6;
        }

        button.secondary {
            background: #374151;
        }

        button.secondary:hover {
            background: #4b5563;
        }

        .hidden {
            display: none !important;
        }

        .results-container {
            background: #0d0d1a;
            border-radius: 16px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
        }

        .results-container h2 {
            color: #6366f1;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: #16213e;
            border-radius: 12px;
            padding: 20px;
        }

        .result-card h3 {
            font-size: 0.95rem;
            color: #888;
            margin-bottom: 10px;
        }

        .result-card .value {
            font-size: 1.8rem;
            color: #fff;
            font-weight: 600;
        }

        .result-card .unit {
            font-size: 0.9rem;
            color: #6366f1;
            margin-left: 5px;
        }

        .effect-card {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: center;
        }

        .effect-card h3 {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
        }

        .effect-card .value {
            font-size: 2.5rem;
            color: #fff;
            font-weight: 700;
        }

        .effect-card .unit {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .interpretation {
            background: #16213e;
            border-radius: 12px;
            padding: 20px;
            color: #bbb;
            line-height: 1.7;
            font-size: 0.95rem;
        }

        .interpretation em {
            color: #6366f1;
            font-style: normal;
        }

        .instructions {
            background: #16213e;
            border-radius: 12px;
            padding: 25px;
            max-width: 600px;
            margin-top: 20px;
        }

        .instructions h2 {
            font-size: 1.1rem;
            margin-bottom: 12px;
            color: #6366f1;
        }

        .instructions p {
            color: #bbb;
            line-height: 1.6;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .instructions em {
            color: #6366f1;
            font-style: normal;
        }

        .start-hint {
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid rgba(99, 102, 241, 0.4);
            border-radius: 8px;
            padding: 15px 25px;
            margin: 15px 0;
            text-align: center;
            color: #a5b4fc;
            font-size: 0.95rem;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">&larr; Back to experiments</a>

    <h1>Stopped Clock Illusion</h1>
    <p class="subtitle">Rate how long each clock tick feels. Compare what happens when you shift your gaze versus when you're already watching.</p>

    <div id="start-screen">
        <div class="demo-container">
            <p class="prompt-text">Ready to begin the experiment?</p>
            <p style="color: #888; text-align: center; max-width: 400px; line-height: 1.6; margin-bottom: 20px;">
                You will complete 8 trials: 4 saccade trials (shift gaze to clock) and 4 control trials (already watching clock).
                After each trial, rate how long the first tick felt.
            </p>
            <div class="buttons">
                <button id="start-btn">Start Experiment</button>
            </div>
        </div>
    </div>

    <div id="experiment-screen" class="hidden">
        <div class="demo-container">
            <div class="trial-info">
                <div class="trial-indicator" id="trial-indicator">Trial 1 of 8</div>
                <div class="trial-type" id="trial-type">Saccade Trial</div>
            </div>

            <div class="experiment-area">
                <div class="fixation-area" id="fixation-area">
                    <span class="fixation-cross" id="fixation-cross">+</span>
                    <span class="cue-text" id="cue-text">NOW look at the clock!</span>
                </div>
                <div class="clock-area">
                    <canvas id="clock" width="200" height="200"></canvas>
                </div>
            </div>

            <p class="prompt-text" id="prompt-text">Fixate on the + and wait for the cue...</p>

            <div class="start-hint" id="trial-hint">Press SPACE to start this trial</div>
        </div>

        <div id="response-section" class="demo-container hidden">
            <p class="prompt-text">How long did the FIRST tick feel?</p>
            <div class="response-section">
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>Very Short</span>
                        <span>Normal</span>
                        <span>Very Long</span>
                    </div>
                    <input type="range" id="duration-slider" min="1" max="7" value="4" step="1">
                    <div class="slider-scale">
                        <span>1</span>
                        <span>2</span>
                        <span>3</span>
                        <span>4</span>
                        <span>5</span>
                        <span>6</span>
                        <span>7</span>
                    </div>
                </div>
                <div class="slider-value" id="slider-value">4 - Normal</div>
                <div class="buttons">
                    <button id="submit-btn">Submit Response</button>
                </div>
            </div>
        </div>
    </div>

    <div id="results-screen" class="results-container hidden">
        <h2>Your Results</h2>

        <div class="results-grid">
            <div class="result-card">
                <h3>Saccade Trials (Shifted Gaze)</h3>
                <p><span class="value" id="saccade-avg">--</span><span class="unit">/ 7</span></p>
            </div>
            <div class="result-card">
                <h3>Control Trials (Already Watching)</h3>
                <p><span class="value" id="control-avg">--</span><span class="unit">/ 7</span></p>
            </div>
        </div>

        <div class="effect-card">
            <h3>Chronostasis Effect</h3>
            <p><span class="value" id="chronostasis-effect">--</span><span class="unit">difference</span></p>
        </div>

        <div class="interpretation" id="interpretation">
            <p>Loading interpretation...</p>
        </div>

        <div class="buttons" style="margin-top: 25px;">
            <button id="restart-btn">Try Again</button>
        </div>
    </div>

    <div class="instructions" id="instructions-section">
        <h2>The Phenomenon</h2>
        <p>The <em>stopped clock illusion</em> (chronostasis) occurs when you shift your gaze to a clock and the second hand appears to freeze momentarily before starting to move again. That first tick seems to last longer than subsequent ticks.</p>
        <p>This happens because your brain <em>backdates</em> visual information to fill in the gap created during the eye movement (saccade). During a saccade, you are effectively blind for about 50-100ms, but you never notice this gap because your brain fills it with the first image you see after the movement.</p>

        <h2>The Experiment</h2>
        <p>In <em>saccade trials</em>, you fixate on the + and then shift your gaze to the clock when cued. The first tick you see should feel longer than normal.</p>
        <p>In <em>control trials</em>, you are already watching the clock, so there is no saccade-induced time distortion. The ticks should feel more uniform in duration.</p>

        <h2>The Philosophical Point</h2>
        <p>Chronostasis reveals that our <em>conscious experience of the present is partially constructed after the fact</em>. The brain does not simply relay sensory information as it arrives; it actively edits and confabulates to create a seamless narrative of experience.</p>
        <p>We often assume consciousness is a direct window onto the present moment. Instead, what we experience as "now" may be a <em>post-produced reconstruction</em>, smoothed and filled in to hide gaps in our sensory processing.</p>
    </div>

    <script>
        // Canvas setup
        const canvas = document.getElementById('clock');
        const ctx = canvas.getContext('2d');
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const radius = 90;

        // Clock state
        let currentSecond = 0;
        let clockRunning = false;
        let tickInterval = null;
        let tickCount = 0;
        let firstTickTime = 0;

        // Experiment state
        const totalTrials = 8;
        let currentTrial = 0;
        let trialTypes = []; // Will be shuffled array of 'saccade' and 'control'
        let experimentState = 'idle'; // idle, waiting, running, responding

        // Results
        const results = {
            saccade: [],
            control: []
        };

        // DOM elements
        const startScreen = document.getElementById('start-screen');
        const experimentScreen = document.getElementById('experiment-screen');
        const resultsScreen = document.getElementById('results-screen');
        const responseSection = document.getElementById('response-section');
        const trialIndicator = document.getElementById('trial-indicator');
        const trialTypeElem = document.getElementById('trial-type');
        const promptText = document.getElementById('prompt-text');
        const trialHint = document.getElementById('trial-hint');
        const fixationCross = document.getElementById('fixation-cross');
        const cueText = document.getElementById('cue-text');
        const durationSlider = document.getElementById('duration-slider');
        const sliderValue = document.getElementById('slider-value');
        const instructionsSection = document.getElementById('instructions-section');

        // Shuffle array (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Initialize trial types
        function initTrialTypes() {
            trialTypes = [];
            for (let i = 0; i < 4; i++) {
                trialTypes.push('saccade');
                trialTypes.push('control');
            }
            shuffleArray(trialTypes);
        }

        // Draw analog clock
        function drawClock() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Clock face background
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius + 5, 0, Math.PI * 2);
            ctx.fillStyle = '#0d0d1a';
            ctx.fill();

            // Clock face border
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius + 5, 0, Math.PI * 2);
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Hour markers
            for (let i = 0; i < 12; i++) {
                const angle = (i * 30 - 90) * Math.PI / 180;
                const innerR = radius - 10;
                const outerR = radius - 3;

                ctx.beginPath();
                ctx.moveTo(centerX + Math.cos(angle) * innerR, centerY + Math.sin(angle) * innerR);
                ctx.lineTo(centerX + Math.cos(angle) * outerR, centerY + Math.sin(angle) * outerR);
                ctx.strokeStyle = '#6366f1';
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            // Center dot
            ctx.beginPath();
            ctx.arc(centerX, centerY, 5, 0, Math.PI * 2);
            ctx.fillStyle = '#374151';
            ctx.fill();

            // Second hand (discrete ticking)
            const handLength = radius - 20;
            const handAngle = (currentSecond * 6 - 90) * Math.PI / 180;

            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(centerX + Math.cos(handAngle) * handLength, centerY + Math.sin(handAngle) * handLength);
            ctx.strokeStyle = '#ef4444';
            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.stroke();

            // Hand tip
            ctx.beginPath();
            ctx.arc(centerX + Math.cos(handAngle) * handLength, centerY + Math.sin(handAngle) * handLength, 4, 0, Math.PI * 2);
            ctx.fillStyle = '#ef4444';
            ctx.fill();
        }

        // Start clock ticking
        function startClock() {
            clockRunning = true;
            tickCount = 0;
            currentSecond = Math.floor(Math.random() * 60); // Random starting position
            drawClock();

            tickInterval = setInterval(() => {
                currentSecond = (currentSecond + 1) % 60;
                tickCount++;
                drawClock();

                // After 5 ticks, stop and ask for response
                if (tickCount >= 5) {
                    stopClock();
                    showResponseUI();
                }
            }, 1000);
        }

        // Stop clock
        function stopClock() {
            clockRunning = false;
            if (tickInterval) {
                clearInterval(tickInterval);
                tickInterval = null;
            }
        }

        // Update slider value display
        function updateSliderDisplay() {
            const value = parseInt(durationSlider.value);
            const labels = ['', 'Very Short', 'Short', 'Slightly Short', 'Normal', 'Slightly Long', 'Long', 'Very Long'];
            sliderValue.textContent = `${value} - ${labels[value]}`;
        }

        // Show response UI
        function showResponseUI() {
            experimentState = 'responding';
            promptText.textContent = '';
            trialHint.classList.add('hidden');
            responseSection.classList.remove('hidden');
            durationSlider.value = 4;
            updateSliderDisplay();
        }

        // Start a trial
        function startTrial() {
            const trialType = trialTypes[currentTrial];

            trialIndicator.textContent = `Trial ${currentTrial + 1} of ${totalTrials}`;
            trialTypeElem.textContent = trialType === 'saccade' ? 'Saccade Trial' : 'Control Trial';

            responseSection.classList.add('hidden');
            cueText.classList.remove('visible');

            if (trialType === 'saccade') {
                fixationCross.style.display = 'block';
                promptText.textContent = 'Fixate on the + and wait for the cue...';
                trialHint.textContent = 'Press SPACE when ready to start';
                trialHint.classList.remove('hidden');
                experimentState = 'idle';
            } else {
                fixationCross.style.display = 'none';
                promptText.textContent = 'Watch the clock and observe the ticks...';
                trialHint.textContent = 'Press SPACE when ready to start';
                trialHint.classList.remove('hidden');
                experimentState = 'idle';
            }

            // Draw initial clock state
            currentSecond = Math.floor(Math.random() * 60);
            drawClock();
        }

        // Handle spacebar press
        function handleSpacebar() {
            if (experimentState === 'idle') {
                const trialType = trialTypes[currentTrial];
                trialHint.classList.add('hidden');
                experimentState = 'waiting';

                if (trialType === 'saccade') {
                    promptText.textContent = 'Keep fixating on the +...';
                    // Random delay before cue (1.5-3 seconds)
                    const delay = 1500 + Math.random() * 1500;
                    setTimeout(() => {
                        if (experimentState === 'waiting') {
                            cueText.classList.add('visible');
                            promptText.textContent = 'Look at the clock NOW!';
                            // Start clock immediately when cue appears
                            experimentState = 'running';
                            startClock();
                        }
                    }, delay);
                } else {
                    promptText.textContent = 'Watch the clock...';
                    // Small delay then start clock
                    setTimeout(() => {
                        if (experimentState === 'waiting') {
                            experimentState = 'running';
                            startClock();
                        }
                    }, 500 + Math.random() * 1000);
                }
            }
        }

        // Submit response
        function submitResponse() {
            const rating = parseInt(durationSlider.value);
            const trialType = trialTypes[currentTrial];

            results[trialType].push(rating);

            currentTrial++;

            if (currentTrial >= totalTrials) {
                showResults();
            } else {
                startTrial();
            }
        }

        // Calculate average
        function average(arr) {
            if (arr.length === 0) return 0;
            return arr.reduce((a, b) => a + b, 0) / arr.length;
        }

        // Show results
        function showResults() {
            experimentScreen.classList.add('hidden');
            instructionsSection.classList.add('hidden');
            resultsScreen.classList.remove('hidden');

            const saccadeAvg = average(results.saccade);
            const controlAvg = average(results.control);
            const effect = saccadeAvg - controlAvg;

            document.getElementById('saccade-avg').textContent = saccadeAvg.toFixed(2);
            document.getElementById('control-avg').textContent = controlAvg.toFixed(2);
            document.getElementById('chronostasis-effect').textContent = (effect >= 0 ? '+' : '') + effect.toFixed(2);

            // Generate interpretation
            const interpretation = document.getElementById('interpretation');
            let text = '';

            if (effect > 0.5) {
                text = `<p>Your results show a <em>positive chronostasis effect</em> of ${effect.toFixed(2)} points. This means that when you shifted your gaze to the clock (saccade trials), the first tick felt noticeably longer than when you were already watching the clock (control trials).</p>
                <p>This is the classic stopped clock illusion. Your brain backdated the visual information from after your eye movement to fill in the perceptual gap caused by the saccade, making that first tick appear to last longer than it actually did.</p>`;
            } else if (effect < -0.5) {
                text = `<p>Your results show a <em>reverse pattern</em>, with control trials rated higher (${controlAvg.toFixed(2)}) than saccade trials (${saccadeAvg.toFixed(2)}). This is unusual but not unheard of.</p>
                <p>This might reflect anticipation effects, where waiting for the cue made the saccade trials feel more expected and thus the ticks felt shorter. Or it could simply reflect individual variation in time perception.</p>`;
            } else {
                text = `<p>Your results show a <em>small difference</em> of ${effect.toFixed(2)} points between saccade and control trials. While the classic chronostasis effect may not be strongly evident in your data, individual results can vary.</p>
                <p>The effect is often subtle and depends on factors like the timing of your eye movement relative to the clock tick. The demonstration is most effective when the first thing you see after your saccade is a tick occurring, which your brain then extends backward in time.</p>`;
            }

            text += `<p style="margin-top: 15px;">What this reveals is that <em>consciousness is not a live feed</em> of reality. Instead, your brain actively constructs and edits your experience, sometimes filling in gaps you never knew existed. The present moment, as you experience it, is at least partially a confabulation.</p>`;

            interpretation.innerHTML = text;
        }

        // Restart experiment
        function restart() {
            currentTrial = 0;
            results.saccade = [];
            results.control = [];
            initTrialTypes();

            resultsScreen.classList.add('hidden');
            experimentScreen.classList.remove('hidden');
            instructionsSection.classList.remove('hidden');

            startTrial();
        }

        // Event listeners
        document.getElementById('start-btn').addEventListener('click', () => {
            initTrialTypes();
            startScreen.classList.add('hidden');
            experimentScreen.classList.remove('hidden');
            startTrial();
        });

        document.getElementById('submit-btn').addEventListener('click', submitResponse);
        document.getElementById('restart-btn').addEventListener('click', restart);

        durationSlider.addEventListener('input', updateSliderDisplay);

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                handleSpacebar();
            }
        });

        // Initial draw
        drawClock();
    </script>
</body>
</html>
